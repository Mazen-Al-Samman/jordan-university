<html>

<head>
    <meta charset="utf-8">
    <title>University Guider</title>
    <script src="../js/jquery.js"></script>
    <script src="../js/bootstrap.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="../css/bootstrap.css">
    <link rel="stylesheet" href="../css/index.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
</head>

<body>

    <!--Start NAVBAR-->
    <nav class="navbar navbar-expand-lg navbar-light bg-light font-poppins-400 hidd">
        <a class="navbar-brand" href="#">University Guider</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText"
            aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarText">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="#home">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#jordan-uni">Jordan universities</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#about">About us</a>
                </li>
            </ul>
            <span class="navbar-text">
                Follow us to get the latest news about jordanian universities.
            </span>
        </div>
    </nav>
    <div class="hidd">
        <div class="main-img-cont">
            <div class="main-img">
                <h1 class="position-absolute font-lobster text-right text p-3 text-light"><span
                        class="text-warning study-text">Your study</span> is our most important <br><span
                        class="text-warning study-text">Mission</span></h1>
            </div>
        </div>
    </div>
    <!--End NAVBAR-->

    <!--Main content-->
    <div class="container hidd" id="home">
        <div class="row d-flex justify-content-center">
            <div class="col-md-12 text-center">
                <h1 class="font-cairo mt-4 text-dark">الرئيسية</h1>
            </div>
            <br>
            <div class="break-line"></div>
            <div class="col-md-8 text-center font-cairo mt-4" dir="rtl">
                <p class="line">
                    المرحلة الأصعب في حياة كل طالب هي إختيار التخصص الذي يتناسب مع قدراته, معدله وسوق العمل الأردني
                    <br>
                    لذلك نقوم نحن كـ فريق
                    <span class="text-info underline">University Guider </span>
                    بمساعدتك لتختار التخصص المناسب لك وفي الجامعة التي ترغب بها.
                </p>
                <button class="btn btn-dark mt-3">سجل الان</button>
            </div>
        </div>
    </div>
    <!--End Main content-->

    <!--Back button-->
    <div class="d-flex justify-content-center hidd">
        <img class="effect mt-5 mb-3" id="back" src="https://img.icons8.com/wired/64/000000/circled-left-2.png" />
    </div>
    <!--End Back button-->

    <div id="loading" class="body">
        <div class="loader">
            <div class="circle"></div>
            <div class="circle"></div>
            <div class="circle"></div>
        </div>
    </div>

    <div class="container-filter font-cairo text-center shadow p-5 hidd mb-5 bg-white rounded">
        <h2 class="text-center mb-5">فلترة النتائج</h2>
        <p class="text-center mb-5 text-grey">يمكنك فلترة النتائج بالإعتماد على المدخلات في الأسفل , ليس من الضروري
            إختيار قيم لجميع المدخلات</p>
        <div class="row">
            <div class="col-lg-4 mb-4 col-12 col-sm-12">
                <label class="hidd" for="price">السعر الأعلى للتخصص</label>
                <input id="price" type="tel" class="hidd form-control text-center" placeholder="السعر الأعلى">
            </div>
            <div class="col-lg-4 mb-4 col-12 col-sm-12">
                <label class="hidd" for="gba">المعدل الأدنى للتتخصص</label>
                <input id="gba" type="tel" class="hidd form-control text-center" placeholder="المعدل الأدنى">
            </div>
            <div class="col-lg-4 mb-4 col-12 col-sm-12">
                <label class="hidd" for="uni">الجامعة</label>
                <select class="form-control" name="university" id="uni-list"></select>
            </div>
        </div>
        <button class="btn btn-info mt-3" id="clear">مسح القيم</button>
        <button class="btn btn-dark mt-3" id="execute">تنفيذ</button>
    </div>

    <div id="jordan-uni" class="hidd">
        <div class="container-fluid text-center mt-5" id="main-content">
            <!--Universities contents.-->
        </div>

        <div class="container-fluid text-center mt-5" id="college-section">
            <!-- Colleges content -->
        </div>

        <div class="container-fluid text-center mt-5" id="major-section">
            <!-- Colleges content -->
        </div>

        <div class="container-fluid text-center mt-5" id="filtered-data">
            <!-- Colleges content -->
        </div>

        <footer id="about" class="hidd">
            <div class="footer font-cairo">
                <div class="footer_about"></div>
                <div class="footer_main text-center">
                    <h3>من نحن ؟</h3>
                    <p class="mt-3">فريق من شباب وشابات جامعة الزرقاء, قمنا بإنشاء هذا المشروع لمساعدة طلبة الثانوية
                        العامة
                        في اختبار التخصص المتناسب مع معدلاتهم ورغباتهم</p>
                </div>
                <div class="footer_right"></div>
            </div>
            <div class="copyright font-poppins-400">
                Copyright © 2021 All Rights Reserved by University Guider.
            </div>
        </footer>

</body>

</html>
<script src="../js/data.js"></script>
<script>
    var universities = [];
    var colleges = [];
    var majors = [];
    var current_page = 'main';
    $('#back').hide();
    $('.hidd').hide();
    $.ajax({
        url: 'https://222001556bdf.ngrok.io/universities/?min_gba=100',
        type: 'GET',
        success: function (response) {
            universities = response.payload;
            $('document').ready(function () {
                $('#college-section').hide();
                $('#major-section').hide();
                let uni_list = ``;
                let html_code = `
                    <div class="row">
                        <div class="col-md-1"></div>
                        <div class="col-md-10">
                            <div class="shadow-lg p-3 mb-5 bg-white rounded">
                            <h2 class="font-cairo">الجامعات الأردنية</h2>
                            <hr>
                            <div class="row d-flex justify-content-center p-5" id="universities">
                    `;
                for (let i = 0; i < universities.length; i++) {
                    let name = universities[i]['university_name'];
                    let img = universities[i]['university_code'] + '.png';
                    let code = universities[i]['university_code'];
                    let click = universities[i]['university_code'];
                    if (name.length > 25) {
                        name = name.substring(0, 25) + '...';
                    }

                    html_code += `
                        <div data-click-uni="${click}" data-click-name="${name}" class="pointer col-12 col-lg-3 col-sm-12 ml-4 shadow p-3 mb-5 bg-white rounded effect uni-box font-cairo">
                            <h2 data-click-uni="${click}" class="pointer height-100" data-click-name="${name}">${name}</h2>
                            <img data-click-uni="${click}" data-click-name="${name}" width="150" src="../img/${img}" class="pointer img-fluid mt-3" alt="">
                        </div>
                    `;

                    uni_list += `<option value="${code}">${name}</option>`
                }

                if (universities.length == 0) {
                    html_code += `<h4>لا يوجد معلومات</h4>`
                }

                html_code += `
                            </div>
                        </div>
                    </div>
                </div>
                `;
                $('#main-content').append(html_code);
                $('#uni-list').append(uni_list);
                setTimeout(() => {
                    $('.hidd').fadeIn();
                    $('.body').css('display', 'none')
                }, 1000);
            });
        }
    });

    $('body').on('click', '.uni-box', function (e) {
        $('#back').fadeIn('100');
        current_page = 'college';
        $('#major-section').hide();
        let clicked_uni = e.target.getAttribute("data-click-uni");
        let clicked_uni_name = e.target.getAttribute("data-click-name");
        $('#back').hide();
        $('.hidd').hide();
        $('.body').css('display', 'flex');
        $.ajax({
            url: `https://222001556bdf.ngrok.io/universities/${clicked_uni}/colleges`,
            type: 'GET',
            success: function (response) {
                colleges = response.payload;
                $('#main-content').fadeOut(250);
                let html_code = `
                <div class="row">
                    <div class="col-md-1"></div>
                    <div class="col-md-10">
                        <div class="shadow-lg p-3 mb-5 bg-white rounded font-cairo" id="uni-collages">
                        <h2>${clicked_uni_name}</h2>
                        <hr>
                        <div class="row d-flex justify-content-center p-5" id="collages">
                `;
                for (let i = 0; i < colleges.length; i++) {
                    let name = colleges[i]['college_name'];
                    let college_code = colleges[i]['college_code'];
                    html_code += `
                        <div data-college-name="${name}" data-uni-name="${clicked_uni_name}" data-clicked-uni="${clicked_uni}" data-college-code="${college_code}" class="pointer col-12 col-lg-3 col-sm-12 ml-4 shadow p-3 mb-5 bg-white rounded effect collage-click">
                            <h2 data-college-name="${name}" data-uni-name="${clicked_uni_name}" data-clicked-uni="${clicked_uni}" data-college-code="${college_code}" class="font-cairo">${name}</h2>
                        </div>
                    `;
                    $('#collages').append(html_code);
                }

                if (colleges.length == 0) {
                    html_code += `<h4>لا يوجد معلومات</h4>`
                }

                html_code += `
                            </div>
                        </div>
                    </div>
                </div>
                `;
                $('#college-section').html(html_code)
                $('#college-section').fadeIn(250);
                setTimeout(() => {
                    $('.hidd').fadeIn();
                    $('.body').css('display', 'none');
                    $('#back').fadeIn();
                }, 1000);
            }
        });
    });

    $('body').on('click', '.collage-click', function (e) {
        $('#back').hide();
        $('.hidd').hide();
        $('.body').css('display', 'flex');
        current_page = 'major';
        let col_code = e.target.getAttribute('data-college-code');
        let uni_code = e.target.getAttribute('data-clicked-uni');
        let uni_name = e.target.getAttribute('data-uni-name');
        let college_name = e.target.getAttribute('data-college-name');
        $.ajax({
            url: `https://222001556bdf.ngrok.io/majors/?university_code=${uni_code}&college_code=${col_code}`,
            type: 'GET',
            success: function (res) {
                majors = res.payload;
                let html_code = `
                <div class="row">
                    <div class="col-md-1"></div>
                    <div class="col-md-10">
                        <div class="shadow-lg p-3 mb-5 bg-white rounded font-cairo">
                        <h2>${uni_name} - ${college_name}</h2>
                        <hr>
                        <div class="row d-flex justify-content-center p-5" id="universities">
                `;
                for (let i = 0; i < majors.length; i++) {
                    let name = majors[i]['major_name'];
                    let price = majors[i]['price'];
                    let min_gba = majors[i]['min_gba'];

                    html_code += `
                    <div class="pointer col-12 col-lg-3 col-sm-12 ml-4 shadow p-3 mb-5 bg-white rounded effect cursor">
                        <h2 class="font-cairo mb-3">${name}</h2>
                        <hr>
                        <p class="font-cairo">${price} JOD / Hour</p>
                        <p class="font-cairo" dir="rtl">${min_gba}%  أو أكثر</p>
                    </div>
                `;
                }

                if (majors.length == 0) {
                    html_code += `<h4>لا يوجد معلومات</h4>`
                }

                html_code += `
                        </div>
                    </div>
                </div>
            </div>
            `;

                $('#major-section').html(html_code);
                $('#college-section').hide();
                $('#major-section').fadeIn(250);
                setTimeout(() => {
                    $('.hidd').fadeIn();
                    $('.body').css('display', 'none');
                    $('#back').fadeIn();
                }, 1000);
            }
        });
    });

    $('#back').on('click', function () {
        if (current_page == 'college') {
            current_page = 'main';
            $('#college-section').hide();
            $('#major-section').hide();
            $('#main-content').fadeIn(250);
            $('#back').hide();
        } else if (current_page == 'major') {
            current_page = 'college';
            $('#college-section').fadeIn(250);
            $('#major-section').hide();
            $('#main-content').hide();
            $('#back').fadeIn('100');
        }
    });

    $('#execute').on('click', function () {
        let selected_price = $('#price').val();
        let selected_gba = $('#gba').val();
        let selected_uni = $('#uni-list').val();
        $('#back').hide();
        $('.hidd').hide();
        $('.body').css('display', 'flex');
        let api_data = `https://222001556bdf.ngrok.io/majors/?university_code=TUJ`;
        if (selected_price != '') {
            api_data += `&price=${selected_price}`;
        }
        if (selected_gba != '') {
            api_data += `&min_gba=${selected_gba}`;
        }

        $.ajax({
            url: api_data,
            type: 'GET',
            success: function (res) {
                let filtered = res.payload;
                let html_code = `
                <div class="row">
                    <div class="col-md-1"></div>
                    <div class="col-md-10">
                        <div class="shadow-lg p-3 mb-5 bg-white rounded font-cairo">
                        <h2>التخصصات المطابقة للبحث</h2>
                        <hr>
                        <div class="row d-flex justify-content-center p-5" id="universities">
                `;
                for (let i = 0; i < filtered.length; i++) {
                    let name = filtered[i]['major_name'];
                    let price = filtered[i]['price'];
                    let min_gba = filtered[i]['min_gba'];

                    html_code += `
                    <div class="pointer col-12 col-lg-3 col-sm-12 ml-4 shadow p-3 mb-5 bg-white rounded effect cursor">
                        <h2 class="font-cairo mb-3">${name}</h2>
                        <hr>
                        <p class="font-cairo">${price} JOD / Hour</p>
                        <p class="font-cairo" dir="rtl">${min_gba}%  أو أكثر</p>
                    </div>
                `;
                }
                
                if (filtered.length == 0) {
                    html_code += `<h4>لا يوجد معلومات</h4>`
                }

                html_code += `
                        </div>
                    </div>
                </div>
            </div>
            `;

                $('#filtered-data').html(html_code);
                $('#college-section').hide();
                $('#major-section').hide();
                $('#main-content').hide();
                $('#filtered-data').fadeIn(250);
                setTimeout(() => {
                    $('.hidd').fadeIn();
                    $('.body').css('display', 'none');
                }, 1000);
            }
        })
    });

    $('#clear').on('click', function(){
        let selected_price = $('#price').val("");
        let selected_gba = $('#gba').val("");
        let selected_uni = $('#uni-list').val("TUJ");
        $('#filtered-data').html('');
        $('#filtered-data').hide();
        $('#main-content').fadeIn(250);
    });
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();

            document.querySelector(this.getAttribute('href')).scrollIntoView({
                behavior: 'smooth'
            });
        });
    });
</script>